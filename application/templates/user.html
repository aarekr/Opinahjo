{% extends "layout.html" %}

{% block body %}
    <h1>Hei, {{ user.username }}</h1>

    <!-- profiili -->
    {% if user.student %}
    <h6>(Opiskelija)</h6>
    {% elif user.teacher %}
    <h6>(Opettaja)</h6>
    {% endif %}
    <hr>

<!-- opiskelijalle näytetään kurssi-ilmoittautumiset -->
{% if user.student %}
  {% if student_my_courses is defined %}
  <b>Ilmoittautumiset</b>
    <ul>
      {% for course in student_my_courses %}
        {% if user.username == course.student %}
          <li>{{course.kurssi}}</li>
        {% endif %}
      {% endfor %}
    </ul>
  <hr>
  {% endif %}
{% endif %}



<!-- opettajan näkymä -->
{% if user.teacher %}
  {% if teacher_my_courses is defined %}
  <b>Minun opettamat kurssit</b> <br />
  <ul>
    {% for course in teacher_my_courses %}
      {% if user.id==course.teacher %} <!-- kirjautunut opettaja -->
      <li>{{course.name}} <br/>
      <a href="{{ url_for('kurssit_modify', kurssi_id=course.id) }}">
        <input type="submit" value="Muokkaa" style="width:150px"/></a>
      <form method="POST" action="{{ url_for('kurssit_delete', kurssi_id=course.id) }}">
        <input type="submit" value="Poista kurssi" style="width:150px"/>
      </form>
      </li>
      {% endif %}
    {% endfor %}
  </ul>
  {% endif %}
<hr>
{% endif %}


{% if user.teacher %}
  {% if all_enrollments is defined %}
  <b>Minun kursseille ilmoittautuneet opiskelijat</b> <br />
  <table border="1">
    <tr>
      <th width="200" style="text-align: center">Kurssi</th>
      <th width="120" style="text-align: center">Opiskelija</th>
    </tr>
    {% for row in all_enrollments %}
    {% if row.teacher == user.id %}
    <tr>
      <td>{{row.course}}</td>
      <td style="text-align: center">{{row.student}}</td>
    </tr>
    {% endif %}
    {% endfor %}
  </table>
  {% endif %}
<hr>
{% endif %}


{% if user.teacher %}
  {% if student_enrollments_count is defined %}
  <b>Opiskelijakohtaiset ilmoittautumismäärät</b> <br />
  <table border="1">
    <tr>
      <th width="100" style="text-align: center">Nimi</th>
      <th width="100" style="text-align: center">Kursseja</th>
    </tr>
    {% for row in student_enrollments_count %}
    {% if row.student %}
    <tr>
      <td style="text-align: center">{{row.name}}</td>
      <td style="text-align: center">{{row.count}}</td>
    </tr>
    {% endif %}
    {% endfor %}
  </table>
  {% endif %}
<hr>
{% endif %}

{% endblock %}
